(()=>{"use strict";({607:function(){var t=this&&this.__assign||function(){return t=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},t.apply(this,arguments)},e=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{l(o.next(t))}catch(t){i(t)}}function c(t){try{l(o.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}l((o=o.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&c[0]?o.return:c[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,c[1])).done)return r;switch(o=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){a.label=c[1];break}if(6===c[0]&&a.label<r[1]){a.label=r[1],r=c;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(c);break}r[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],o=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},o=this&&this.__rest||function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n},r=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};e(void 0,void 0,void 0,(function(){var i,a,c,l,s,u,h,f,d,p,v,y,w,g,m,b;return n(this,(function(k){switch(k.label){case 0:if(i=1.5,!(a=document.getElementById("shark-game")))throw new Error("Container not found");return c={ids:{},hitboxes:{}},l=0,s=0,u=r([{id:"background",src:"background.png",width:394,left:29,top:29},{id:"frame",src:"frame.png",width:448,left:0,top:0},{id:"shark",src:"shark.png",width:396,left:30,top:28}],r([],Array(20),!0).map((function(t,e){var n=e+1;return{id:"tooth-".concat(n),src:n<10?"tooth_0".concat(n,".png"):"tooth_".concat(n,".png"),width:392,left:30,top:30}})),!0),h=u.map((function(e){var n=e.width,r=e.left,a=e.top,c=o(e,["width","left","top"]);return t({width:Math.floor(n*i),height:Math.floor(404/390*n*i),left:Math.floor(r*i),top:Math.floor(a*i)},c)})),h.forEach((function(t){var e=t.width,n=t.height;l<e&&(l=e),s<n&&(s=n)})),a.style.position="relative",a.style.width="".concat(l,"px"),a.style.height="".concat(s,"px"),f=function(o){return e(void 0,void 0,void 0,(function(){var e,r,i,a,u,h,f,d;return n(this,(function(n){return e=o.id,r=o.src,i=o.width,a=o.height,u=o.left,h=o.top,f=document.createElement("div"),(d=document.createElement("img")).src="images/".concat(r),f.appendChild(d),[2,new Promise((function(n){var r=function(f){if(e.startsWith("tooth")&&!c.ids[e]){c.ids[e]=!0;var p=document.createElement("canvas");p.width=l,p.height=s;var v=p.getContext("2d");if(!v)throw new Error("Something wonky with this context yo");v.drawImage(d,u,h,i,a);for(var y=v.getImageData(0,0,l,s).data,w=0;w<l;w++)for(var g=0;g<s;g++)y[4*(g*l+w)+3]>1&&(c.hitboxes["".concat(w,"-").concat(g)]=e)}n(t(t({},o),{image:d})),d.removeEventListener("load",r)};d.addEventListener("load",r)}))]}))}))},[4,Promise.all(h.map(f))];case 1:if(d=k.sent(),p=function(e){var n=document.createElement("canvas");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.background="transparent",n.width=l,n.height=s;var o=n.getContext("2d");if(!o)throw new Error("Something wonky with this context yo");return o.imageSmoothingEnabled=!1,a.appendChild(n),t(t({},e),{canvas:n,ctx:o})},v=d.map(p),y=function(t){var e=t.ctx,n=t.image,o=t.left,r=t.top,i=t.width,a=t.height,c=t.tint,u=void 0===c?null:c;if(t.clear)e.clearRect(0,0,l,s);else if(u){var h=u.color,f=u.alpha,d=void 0===f?.5:f,p=document.createElement("canvas");p.width=l,p.height=s;var v=p.getContext("2d");if(!v)throw new Error("Something wonky with this context yo");v.clearRect(0,0,l,s),v.drawImage(n,o,r,i,a),v.fillStyle=h,v.globalCompositeOperation="multiply",v.fillRect(0,0,l,s),v.globalAlpha=d,v.globalCompositeOperation="destination-in",v.drawImage(n,o,r,i,a),e.drawImage(p,0,0,l,s)}else e.drawImage(n,o,r,i,a)},v.forEach((function(t){return y(t)})),w={state:"select-cavity"},g={lock:null},m=function(){var t,e,n,o=document.getElementById("instructions-content");if(!o)throw new Error("Instructions content area not found");switch(w.state){case"select-cavity":o.textContent="Select the tooth with the cavity!";break;case"select-tooth":var r=(t=21-w.cavity,e=21-(w.selected||0),n=e-t-1,{rem:n%4,quot:Math.floor((n-1)/4)}).rem;o.textContent="Select the currently played tooth!\nIf it's your turn, then play ".concat(r||1,"!");break;case"win":o.textContent="If it's your turn, then you've won!"}},!(b=document.getElementById("reset")))throw new Error("Reset button not found");return b.addEventListener("click",(function(){return e(void 0,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return g.lock?[4,g.lock]:[3,2];case 1:t.sent(),t.label=2;case 2:return w={state:"select-cavity"},v.filter((function(t){return t.id.startsWith("tooth")})).map(y),m(),[2]}}))}))})),a.addEventListener("click",(function(o){return e(void 0,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return null!==g.lock?[2]:(g.lock=new Promise((function(r){return e(void 0,void 0,void 0,(function(){var e,i,l,s,u,h,f,d;return n(this,(function(p){switch(p.label){case 0:return a.getBoundingClientRect(),e=Math.floor(o.offsetX),i=Math.floor(o.offsetY),(l=c.hitboxes["".concat(e,"-").concat(i)])?(s=v.find((function(t){return t.id===l})),s?(u=parseInt(l.split("-")[1],10),"select-cavity"!==w.state?[3,1]:(y(t(t({},s),{tint:{color:"#F00000",alpha:.3}})),w={state:"select-tooth",cavity:u,selected:null},[3,6])):[3,6]):[3,7];case 1:if(!(u<w.cavity&&(null==w.selected||w.selected<u)))return[3,6];h=function(e){var o;return n(this,(function(n){switch(n.label){case 0:return o=v.find((function(t){return t.id==="tooth-".concat(e)})),o?(y(t(t({},o),{clear:!0})),[4,(150,new Promise((function(t){return setTimeout(t,150)})))]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))},f=null!==(d=w.selected)&&void 0!==d?d:1,p.label=2;case 2:return f<=u?[5,h(f)]:[3,5];case 3:p.sent(),p.label=4;case 4:return f++,[3,2];case 5:w=u+1===w.cavity?{state:"win",cavity:w.cavity,selected:u}:{state:"select-tooth",cavity:w.cavity,selected:u},p.label=6;case 6:m(),p.label=7;case 7:return r(),[2]}}))}))})),[4,g.lock]);case 1:return r.sent(),g.lock=null,[2]}}))}))})),[2]}}))}))}})[607]()})();
//# sourceMappingURL=main.js.map