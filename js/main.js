(()=>{"use strict";({607:function(){var t=this&&this.__assign||function(){return t=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},t.apply(this,arguments)},e=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,a){function i(t){try{l(o.next(t))}catch(t){a(t)}}function c(t){try{l(o.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,c)}l((o=o.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&c[0]?o.return:c[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,c[1])).done)return r;switch(o=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,o=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){i.label=c[1];break}if(6===c[0]&&i.label<r[1]){i.label=r[1],r=c;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(c);break}r[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],o=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},o=this&&this.__rest||function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n},r=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var o,r=0,a=e.length;r<a;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};e(void 0,void 0,void 0,(function(){var a,i,c,l,s,h,f,u,d,p,v,y,g;return n(this,(function(w){switch(w.label){case 0:if(a=1.5,!(i=document.getElementById("shark-game")))throw new Error("Container not found");return c={ids:{},hitboxes:{}},l=0,s=0,h=r([{id:"background",src:"background.png",width:394,left:29,top:29},{id:"frame",src:"frame.png",width:448,left:0,top:0},{id:"shark",src:"shark.png",width:392,left:30,top:30}],r([],Array(20),!0).map((function(t,e){var n=e+1;return{id:"tooth-".concat(n),src:n<10?"tooth_0".concat(n,".png"):"tooth_".concat(n,".png"),width:392,left:30,top:30}})),!0),f=h.map((function(e){var n=e.width,r=e.left,i=e.top,c=o(e,["width","left","top"]);return t({width:Math.floor(n*a),height:Math.floor(404/390*n*a),left:Math.floor(r*a),top:Math.floor(i*a)},c)})),f.forEach((function(t){var e=t.width,n=t.height;l<e&&(l=e),s<n&&(s=n)})),i.style.position="relative",i.style.width="".concat(l,"px"),i.style.height="".concat(s,"px"),u=function(o){return e(void 0,void 0,void 0,(function(){var e,r,a,i,h,f,u,d;return n(this,(function(n){return e=o.id,r=o.src,a=o.width,i=o.height,h=o.left,f=o.top,u=document.createElement("div"),(d=document.createElement("img")).src="images/".concat(r),u.appendChild(d),[2,new Promise((function(n){var r=function(u){if(e.startsWith("tooth")&&!c.ids[e]){c.ids[e]=!0;var p=document.createElement("canvas");p.width=l,p.height=s;var v=p.getContext("2d");if(!v)throw new Error("Something wonky with this context yo");v.drawImage(d,h,f,a,i);for(var y=v.getImageData(0,0,l,s).data,g=0;g<l;g++)for(var w=0;w<s;w++)y[4*(w*l+g)+3]>1&&(c.hitboxes["".concat(g,"-").concat(w)]=e)}n(t(t({},o),{image:d})),d.removeEventListener("load",r)};d.addEventListener("load",r)}))]}))}))},[4,Promise.all(f.map(u))];case 1:return d=w.sent(),p=function(e){var n=document.createElement("canvas");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.background="transparent",n.width=l,n.height=s;var o=n.getContext("2d");if(!o)throw new Error("Something wonky with this context yo");return o.imageSmoothingEnabled=!1,i.appendChild(n),t(t({},e),{canvas:n,ctx:o})},v=d.map(p),y=function(t){var e=t.ctx,n=t.image,o=t.left,r=t.top,a=t.width,i=t.height,c=t.tint,h=void 0===c?null:c;if(t.clear)e.clearRect(0,0,l,s);else if(h){var f=h.color,u=h.alpha,d=void 0===u?.5:u,p=document.createElement("canvas");p.width=l,p.height=s;var v=p.getContext("2d");if(!v)throw new Error("Something wonky with this context yo");v.clearRect(0,0,l,s),v.drawImage(n,o,r,a,i),v.fillStyle=f,v.globalCompositeOperation="multiply",v.fillRect(0,0,l,s),v.globalAlpha=d,v.globalCompositeOperation="destination-in",v.drawImage(n,o,r,a,i),e.drawImage(p,0,0,l,s)}else e.drawImage(n,o,r,a,i)},v.forEach((function(t){return y(t)})),g={state:"select-cavity"},i.addEventListener("click",(function(e){i.getBoundingClientRect();var n=Math.floor(e.offsetX),o=Math.floor(e.offsetY),r=c.hitboxes["".concat(n,"-").concat(o)];if(r){var a=v.find((function(t){return t.id===r}));if(a){var l=parseInt(r.split("-")[1],10);if("select-cavity"===g.state)y(t(t({},a),{tint:{color:"#F00000",alpha:.3}})),g={state:"select-tooth",cavity:l,selected:null};else if(l<g.cavity&&(null==g.selected||g.selected<l)){for(var s=function(e){var n=v.find((function(t){return t.id==="tooth-".concat(e)}));n&&y(t(t({},n),{clear:!0}))},h=1;h<=l;h++)s(h);g={state:"select-tooth",cavity:g.cavity,selected:l}}}var f=document.getElementById("instructions-content");if(!f)throw new Error("Instructions content area not found");switch(g.state){case"select-cavity":f.textContent="Select the tooth with the cavity!";break;case"select-tooth":var u=function(t,e){var n=e-t-1;return{rem:n%4,quot:Math.floor((n-1)/4)}}(21-g.cavity,21-(g.selected||0)).rem;f.textContent="Select the currently played tooth!\nIf it's your turn, then play ".concat(u||1,"!")}}})),[2]}}))}))}})[607]()})();
//# sourceMappingURL=main.js.map